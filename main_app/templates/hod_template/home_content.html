{% extends 'main_app/base.html' %}
{% load static %}
{% block page_title %}{{page_title}}{% endblock page_title %}
{% block content %}
<section class="content">
    <div class="container-fluid">
        <!-- Small boxes (Stat box) -->
        <div class="row">
            <div class="col-lg-3 col-6">
                <div class="small-box bg-info">
                    <div class="inner"><h3>{{total_students}}</h3><p>Total Students</p></div>
                    <div class="icon"><i class="nav-icon fas fa-user-graduate"></i></div>
                    <a href="{% url 'manage_student' %}" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <div class="col-lg-3 col-6">
                <div class="small-box bg-success">
                    <div class="inner"><h3>{{total_staff}}</h3><p>Total Staff</p></div>
                    <div class="icon"><i class="nav-icon fas fa-users"></i></div>
                    <a href="{% url 'manage_staff' %}" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <div class="col-lg-3 col-6">
                <div class="small-box bg-purple">
                    <div class="inner"><h3>{{total_course}}</h3><p>Total Course</p></div>
                    <div class="icon"><i class="nav-icon fas fa-th-list"></i></div>
                    <a href="{% url 'manage_course' %}" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <div class="col-lg-3 col-6">
                <div class="small-box bg-danger">
                    <div class="inner"><h3>{{total_subject}}</h3><p>Total Subjects</p></div>
                    <div class="icon"><i class="nav-icon fas fa-book"></i></div>
                    <a href="{% url 'manage_subject' %}" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>
        </div>
        <!-- /.row -->

        <!-- Staff-Students pie + Subject-attendance bar -->
        <div class="row">
            <div class="col-md-6">
                <div class="card card-dark">
                    <div class="card-header"><h3 class="card-title">Staffs - Students Overview</h3></div>
                    <div class="card-body"><canvas id="pieChart" style="min-height: 250px; height: 250px; max-height: 250px; max-width: 100%;"></canvas></div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card card-dark">
                    <div class="card-header"><h3 class="card-title">Attendance Per Subject</h3></div>
                    <div class="card-body"><canvas id="barChart" style="min-height: 250px; height: 250px; max-height: 250px; max-width: 100%;"></canvas></div>
                </div>
            </div>
        </div>
        <!-- /.row -->
    </div><!-- /.container-fluid -->
</section>
{% endblock content %}

{% block custom_js %}
<script>
  $(document).ready(function(){
    // Pie: total students vs staff
    var donutData = {
        labels: ['Students', 'Staff'],
        datasets: [{ data:[{{total_students}}, {{total_staff}}], backgroundColor : ['#00a65a', '#f39c12'] }]
    };
    var pieChartCanvas = $('#pieChart').get(0).getContext('2d');
    new Chart(pieChartCanvas, { type: 'pie', data: donutData, options: { maintainAspectRatio : false, responsive : true } });

    // Bar: attendance per subject
    var subject_list = {{ subject_list|safe|escape }};
    var attendance_list = {{ attendance_list }};
    var barChartData = {
        labels: subject_list,
        datasets: [{ label: 'Attendance Per Subject', backgroundColor: '#17A2B8', data: attendance_list }]
    };
    var barChartCanvas = $('#barChart').get(0).getContext('2d');
    new Chart(barChartCanvas, { type: 'bar', data: barChartData, options: { responsive: true, maintainAspectRatio: false, scales: { xAxes: [{ stacked: true }], yAxes: [{ stacked: true }] } } });
  });
</script>
{% endblock custom_js %}